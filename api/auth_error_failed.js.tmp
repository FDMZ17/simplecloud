const config = require("../config.js");
const crypto = require("crypto");

module.exports.load = async function(app, db) {
  app.get("/dash", async (req, res) => {
    // res.cookie('userName', 'MyName', { path: '/dash', maxAge: 120000, secure: config.COOKIE_SECURE, sameSite: true });
    // res.cookie('userToken', 'MySuperSecreetToken', { path: '/dash', maxAge: 120000, secure: config.COOKIE_SECURE, sameSite: true }); 

    res.send('<h1>Checking your credentials!</h1>');
    console.log(req.cookies.userName);
    let userData = db.get(req.cookies.userName);
    if (!userData) {
      res.redirect("/auth");
    }
    console.log(userData)
    console.log(req.cookies.userName);
  });
}
